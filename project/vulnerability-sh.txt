vulnerability.sh


#!/bin/bash

# Update and upgrade the system (you can skip this step if you want an outdated system)
sudo apt-get update -y
sudo apt-get upgrade -y

# Install Apache, MySQL, PHP, and other dependencies
sudo apt-get install -y apache2 mysql-server php php-mysql php-gd libapache2-mod-php openssl

# Install Git to clone DVWA
sudo apt-get install -y git

# Clone DVWA from GitHub
cd /var/www/html
sudo git clone https://github.com/digininja/DVWA.git
sudo chown -R www-data:www-data DVWA/
sudo chmod -R 755 DVWA/

# Configure MySQL for DVWA (Note: Using weak credentials)
sudo mysql -e "CREATE DATABASE dvwa;"
sudo mysql -e "CREATE USER 'dvwa'@'localhost' IDENTIFIED BY 'p@ssw0rd';"
sudo mysql -e "GRANT ALL PRIVILEGES ON dvwa.* TO 'dvwa'@'localhost';"
sudo mysql -e "FLUSH PRIVILEGES;"

# Configure DVWA
cd DVWA
sudo cp config/config.inc.php.dist config/config.inc.php
sudo sed -i "s/'root'/'dvwa'/g" config/config.inc.php
sudo sed -i "s/'p@ssw0rd'/'p@ssw0rd'/g" config/config.inc.php

# Set file permissions for the uploads directory
sudo chmod 777 /var/www/html/DVWA/hackable/uploads/

# Restart Apache to apply changes
sudo systemctl restart apache2

# Install and configure a vulnerable FTP server (vsftpd)
sudo apt-get install -y vsftpd
sudo sed -i 's/anonymous_enable=NO/anonymous_enable=YES/g' /etc/vsftpd.conf
sudo sed -i 's/#write_enable=YES/write_enable=YES/g' /etc/vsftpd.conf
sudo sed -i 's/#local_enable=YES/local_enable=YES/g' /etc/vsftpd.conf
sudo systemctl restart vsftpd

# Create a user with weak FTP credentials
sudo adduser ftpuser --gecos "First Last,RoomNumber,WorkPhone,HomePhone" --disabled-password
echo "ftpuser:password" | sudo chpasswd

# Install an outdated version of OpenSSH to allow weak security configurations
sudo apt-get install -y ssh
sudo sed -i 's/PermitRootLogin prohibit-password/PermitRootLogin yes/g' /etc/ssh/sshd_config
sudo sed -i 's/PasswordAuthentication no/PasswordAuthentication yes/g' /etc/ssh/sshd_config
sudo systemctl restart ssh

# Create a user with weak SSH credentials
sudo adduser sshuser --gecos "First Last,RoomNumber,WorkPhone,HomePhone" --disabled-password
echo "sshuser:password" | sudo chpasswd

# Install other vulnerable software (optional, for testing)
# Example: Install a vulnerable version of PHPMyAdmin
sudo apt-get install -y phpmyadmin

# Setup weak PHPMyAdmin credentials (using root password for convenience)
sudo mysql -e "ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'root';"
sudo mysql -e "FLUSH PRIVILEGES;"

# Enable Apache's mod_rewrite (required for DVWA)
sudo a2enmod rewrite
sudo systemctl restart apache2

# Disable SSL/TLS (optional: weakens security but not generally recommended)
# sudo a2dismod ssl
# sudo systemctl restart apache2

echo "Vulnerable environment setup complete. You can access DVWA at http://<instance-ip>/DVWA/"
